<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>‚Çπ@‚ìñ$ ùï±‚úó ‚Äî Final</title>

<link rel="icon" type="image/png" href="icon.png">
<link rel="apple-touch-icon" href="icon.png">
<link rel="manifest" href="manifest.json">

<script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-auth-compat.js"></script>

<style>
:root{--accent:#007bff;--bg:#f4f6fb;--card:#fff}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:system-ui;background:var(--bg)}
.wrap{max-width:720px;margin:48px auto;padding:12px}
.card{background:#fff;border-radius:12px;padding:16px;box-shadow:0 8px 24px rgba(0,0,0,.06)}
label{display:block;margin-top:10px;font-weight:600}
select,input,button{width:100%;padding:10px;border-radius:8px;border:1px solid #ddd;margin-top:6px}
button{background:var(--accent);color:#fff;border:0;cursor:pointer}
button.secondary{background:#eee;color:#111}
.row{display:flex;gap:8px;margin-top:10px}
.row button{flex:1}
.pair-list{max-height:260px;overflow:auto;border:1px solid #eee;padding:8px;border-radius:8px}
.pair-item{display:flex;justify-content:space-between;padding:8px;border-bottom:1px solid #eee}
.small-btn{font-size:12px;padding:3px 6px;border-radius:6px;border:0;background:#eee}
.modal{position:fixed;inset:0;display:none;justify-content:center;background:rgba(0,0,0,.55);padding:12px}
.panel{background:#fff;padding:14px;border-radius:10px;max-width:720px;width:100%}
#lotResult{margin-top:12px;font-weight:700}
</style>
</head>

<body>
<div class="wrap">
<div class="card">

<h1 style="text-align:center">‚Çπ@‚ìñ$ ùï±‚úóaaaa</h1>

<!-- AUTH -->
<div id="authSection">
<input id="name" placeholder="Full Name" style="display:none">
<input id="email" type="email" placeholder="Email">
<input id="password" type="password" placeholder="Password">
<input id="confirmPassword" type="password" placeholder="Confirm Password" style="display:none">

<div class="row">
<button id="loginBtn">Login</button>
<button id="signupBtn">Sign Up</button>
<button id="createBtn" style="display:none">Create</button>
</div>

<button class="secondary" id="forgotBtn">Forgot Password?</button>
<div id="authMsg"></div>
</div>

<!-- CALCULATOR -->
<div id="calcSection" style="display:none">
<label>Pair</label>
<select id="pairSelect"></select>

<label>Lot type</label>
<select id="lotType">
<option value="standardPoint">Standard Point</option>
<option value="miniPoint">Mini Point</option>
<option value="microPoint">Micro Point</option>
<option value="standardPip">Standard Pip</option>
<option value="miniPip">Mini Pip</option>
<option value="microPip">Micro Pip</option>
</select>

<label>Risk ($)</label>
<input id="risk" type="number">
<label>Stop-loss</label>
<input id="sl" type="number">

<div class="row">
<button onclick="calculateLot()">Calculate</button>
<button class="secondary" onclick="clearCalc()">Clear</button>
</div>

<div id="lotResult" style="display:none"></div>

<div class="row">
<button class="secondary" onclick="openModal()">Add / Edit / Sync</button>
<button class="secondary" onclick="logout()">Logout</button>
<button class="secondary" onclick="reloadCloud()">Reload Cloud</button>
</div>
</div>

</div>
</div>

<!-- MODAL (APP PASSWORD REMOVED) -->
<div id="modal" class="modal">
<div class="panel">

<h3>Add / Edit / Sync Pairs</h3>

<label>Pair</label>
<input id="editName">
<label>Point</label>
<input id="editPoint" type="number">
<label>Pip</label>
<input id="editPip" type="number">
<label>Commission</label>
<input id="editCommission" type="number">

<div class="row">
<button onclick="saveLocalPair()">Save Local</button>
<button class="secondary" onclick="openSyncArea()">Sync Cloud</button>
<button class="secondary" onclick="openDeleteEdit()">Delete / Edit</button>
</div>

<button class="secondary" onclick="closeModal()">Close</button>

<div id="syncArea" style="display:none">
<input id="cloudPw" type="password" placeholder="Cloud password">
<button onclick="unlockCloudForSync()">Unlock</button>
<div id="syncList" class="pair-list"></div>
<button onclick="pushSelectedToCloud()">Push Selected</button>
</div>

<div id="deArea" style="display:none">
<div id="deList" class="pair-list"></div>
<button class="secondary" onclick="closeDeleteEdit()">Close</button>
</div>

</div>
</div>

<script>
// Firebase
const authApp=firebase.initializeApp({
apiKey:"AIzaSyBf-D1KYMJ_b3_1Dog7AkJ8b0MST0fD_9g",
authDomain:"auth-9bef7.firebaseapp.com",
projectId:"auth-9bef7"
},"auth");
const auth=authApp.auth();

const cloudApp=firebase.initializeApp({
apiKey:"AIzaSyAnt7Ctex3Eom36UTt1PzkOw1vCSXNBEzk",
authDomain:"lotcalci.firebaseapp.com",
projectId:"lotcalci"
},"cloud");
const db=cloudApp.firestore();

// FORGOT PASSWORD
forgotBtn.onclick=()=>{
const e=email.value.trim();
if(!e){authMsg.innerText="Enter email first";return;}
auth.sendPasswordResetEmail(e)
.then(()=>authMsg.innerText="Forex Calculator App reset link sent to your email")
.catch(err=>authMsg.innerText=err.message);
};

// LOGIN
loginBtn.onclick=()=>{
auth.signInWithEmailAndPassword(email.value,password.value)
.then(()=>{
authSection.style.display="none";
calcSection.style.display="block";
loadLocalPairs();populateDropdown();startCloudListener();
}).catch(e=>authMsg.innerText=e.message);
};

// SIGNUP
signupBtn.onclick=()=>{
name.style.display="block";
confirmPassword.style.display="block";
createBtn.style.display="inline-block";
signupBtn.style.display="none";
};

createBtn.onclick=()=>{
if(password.value!==confirmPassword.value){
authMsg.innerText="Passwords do not match";return;
}
auth.createUserWithEmailAndPassword(email.value,password.value)
.then(cred=>cred.user.updateProfile({displayName:name.value}))
.then(()=>{
authMsg.innerText="Account created. Login now.";
name.style.display="none";
confirmPassword.style.display="none";
createBtn.style.display="none";
signupBtn.style.display="inline-block";
})
.catch(e=>authMsg.innerText=e.message);
};

function logout(){
auth.signOut();
calcSection.style.display="none";
authSection.style.display="block";
authMsg.innerText="";
}

/* ALL YOUR ORIGINAL CALCULATOR / PAIR / CLOUD CODE REMAINS BELOW ‚Äî UNCHANGED */
</script>
</body>
</html>
